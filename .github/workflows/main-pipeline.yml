name: BobApp CI/CD Pipeline
on:
  push:
    branches:
      - main

  pull_request:
    branches:
      - main

jobs:
  ci-back:
    name: CI Back
    if: github.event_name == 'pull_request'
    uses: ./.github/workflows/ci-back.yml
    secrets: inherit

  ci-front:
    name: CI Front
    if: github.event_name == 'pull_request'
    uses: ./.github/workflows/ci-front.yml
    secrets: inherit

  deploy:
    name: Deploy to Docker
    needs:
      - ci-back
      - ci-front
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    uses: ./.github/workflows/deploy.yml
    secrets: inherit